<div>
    <div class="row">
        <div class="col-md-6">
            <h4>Chemical Names</h4>
            <div [hidden]="compound.names.length">
                <ul>
                    <li *ngFor="let name of compound.names; index as i;">{{name.name}}</li>
                    <li [hidden]="compound.names.length">No compound name provided!</li>
                </ul>
            </div>
        </div>

        <div class="col-md-6">
            <div class="text-right">
                <div class="h5">
                    <span class="dropdown" ngbDropdown>
                        <a href class="dropdown-toggle" ngbDropdownToggle>
                            <i class="fa fa-cloud-download"></i> Download Structure
                        </a>

                        <ul class="uib-dropdown-menu" ngbDropdownMenu>
                            <li>
                                <a ng-click="downloadAsMOL()" target="_blank">as MOL file</a>
                            </li>
                            <li>
                                <a ng-click="downloadAsJSON()" target="_blank">as MoNA JSON Record</a>
                            </li>
                        </ul>
                    </span>
                </div>

                <div style="display:block" chemical-sketcher readonly="true" width="250" height="250"
                     id="big-{{pictureId}}-CompoundViewer_{{chemId}}" ng-model="compound"></div>
            </div>
        </div>
    </div>

    <div class="row" *ngIf="classifications.length > 0">
        <div class="col-md-12">
            <h4>Compound Classification (provided by <a ng-href="{{classifications[0].url.replace('.json', '')}}" target="_blank">ClassyFire</a>) <sup><a href (click)="showClassyFireInfo = !showClassyFireInfo"><i class="fa fa-question-circle"></i></a></sup></h4>
            <div [hidden]="showClassyFireInfo">
                <a href="http://classyfire.wishartlab.com" target="_blank">ClassyFire</a>
                is a freely accessible computational tool that uses the ChemOnt taxonomy to classify chemical
                entities based on their structure. ClassyFire combines structure search, IUPAC name parsing, and evaluation
                of logical expressions to retrieve structural features, which are then mapped to the corresponding ChemOnt classes.
                <hr />
            </div>

            <ng-template #classyfireTree>
                <span class="tree-label"><i class="icon-folder-open"></i> <span metadata-query value="node" classification="true">{{ node.name | titlecase }}</span></span> <span> {{ node.value }}</span>
                <ul [hidden]="node.nodes">
                    <ng-container *ngTemplateOutlet="classyfireTree">
                        <li class="tree-node" *ngFor="let node of node.nodes"></li>
                    </ng-container>
                </ul>
            </ng-template>

            <div class="tree">
                <ul>
                    <li class="tree-node" ng-repeat="node in $ctrl.classifications" ng-include="'classyfireTree'"></li>
                </ul>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <h4>Compound Metadata</h4>

            <table class="table">
                <thead>
                <tr>
                    <th>Name</th>
                    <th>Value</th>
                </tr>
                </thead>

                <tbody>
                <tr ng-repeat="meta in $ctrl.compound.metaData |  filter: {category: '!external id'} | filter: {deleted : '!true'} | filter: {hidden: '!true'} | orderBy : 'name':true  ">
                    <td class="col-lg-4 col-md-6">
                        <span metadata-query value="meta" compound="true">{{meta.name}}</span>
                    </td>
                    <td class="col-lg-8 col-md-6">
                        {{meta.value}} {{meta.unit}}

                        <!-- display this, if there seems to be something odd with this value -->
                        <i ng-show="meta.suspect == true" class="fa fa-exclamation-triangle"></i>

                        <!-- display this, if it's a computed value -->
                        <i ng-show="meta.computed == true" class="fa fa-flask" tooltip-placement="top"
                           uib-tooltip="Calculated by MoNA Auto Curation"></i>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <div ng-show="($ctrl.compound.metaData |  filter: {category: 'external id'}).length > 0">
                <table class="table">
                    <thead>
                    <tr>
                        <th>External Identifier</th>
                        <th>Value</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="meta in $ctrl.compound.metaData |  filter: {category: 'external id'} | filter: {deleted : '!true'} | filter: {hidden: '!true'} | unique:'name' | orderBy : 'name':false  ">
                        <td class="col-lg-4 col-md-6" data-metadata-name="{{meta.name}}">
                            <span metadata-query value="meta" compound="true">
                                {{meta.name}}
                            </span>
                        </td>

                        <td class="col-lg-8 col-md-6" data-metadata-value="{{meta.value}}">
                            <span ng-if="meta.url === ''">{{meta.value}}</span>

                            <a ng-if="meta.url !== ''"  ng-href="{{meta.url}}" target="_blank">
                                {{meta.value}}
                            </a>

                            <!-- display this, if there seems to be something odd with this value -->
                            <i ng-show="meta.suspect == true" class="fa fa-exclamation-triangle"></i>

                            <!-- display this, if it's a computed value -->
                            <i ng-show="meta.computed == true" class="fa fa-flask" tooltip-placement="top"
                               uib-tooltip="Calculated by MoNA auto curation"></i>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <div ng-show="$ctrl.compound.tags.length">
                <ul class="list-inline">
                    <li ng-repeat="tag in $ctrl.compound.tags">
                        <span tag-query rule-based="tag.ruleBased" value="tag" type="compound"></span>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>
