<div class="row" *ngIf="!auth.isLoggedIn()">
  <div class="col-md-12">
    <h3><fa-icon [icon]="faUser"></fa-icon> Please <a href="" (click)="auth.requestModal()">log in</a>!</h3>
  </div>
</div>
<toaster-container [toasterconfig]="toasterOptions"></toaster-container>
<div *ngIf="auth.isLoggedIn() && auth.isAdmin()" class="container">
  <div class="row mb-2">
    <div class="col">
      <br/>
      <div class="row justify-content-center">
        <h3>Delete Libraries</h3>
      </div>
      <hr/>
      <div class="row justify-content-start" *ngIf="libraryTags && libraryTags.length > 0">
        <form (ngSubmit)="submitDeletionQuery()" class="col">
          <div *ngFor="let x of libraryTags">
                <label class="clickable">
                    <input class="clickable" type="checkbox" name="libraryTag" [(ngModel)]="x.selected"> {{x.text}} ({{x.count | number: '1.0-0'}} spectra)
                </label>
          </div>
          <div class="row mt-2">
            <div class="col-sm">
              <button type="submit" class="btn btn-danger">Delete Selected Libraries</button>
            </div>
            <div class="col-sm">
              <button type="button" (click)="refreshTags()" class="btn btn-primary">Refresh Libraries</button>
            </div>
          </div>
        </form>
      </div>
    </div>
    <div class="col">
      <br/>
      <div class="row justify-content-center">
        <h3>Admin Buttons (Force Updates)</h3>
      </div>
      <hr/>
      <div class="row justify-content-center mb-2">
        <button class="btn btn-primary mr-2" (click)="updateStatistics()">Update Statistics</button>
      </div>
      <div class="row justify-content-center mb-2">
        <button class="btn btn-primary mr-2" (click)="refreshSimilarity()">Refresh Similarity Service</button>
      </div>
      <div class="row justify-content-center mb-2">
        <button class="btn btn-primary mr-2" (click)="updatePredefinedQueries()">Update Predefined Queries</button>
      </div>
      <div class="row justify-content-center mb-2">
        <button class="btn btn-primary mr-2" (click)="updateStaticQueries()">Update Static Queries</button>
      </div>
      <div class="row justify-content-center mb-2">
        <button class="btn btn-primary mr-2" (click)="reCurateAllData()">Re-Curate All Data</button>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <br/> <br/> <br/> <br/> <br/>
      <div class="row justify-content-center">
        <h3>Force Delete Libraries by ID</h3>
      </div>
      <hr/>
      <div class="row justify-content-center">
        <div class="col mb-1">
          <span>Library IDs:</span>
          <input class="form-control col-sm-3" placeholder="Comma separated, no spaces" type="text" [(ngModel)]="removeIDs"/>
          <p></p>
          <button type="button" class="btn btn-danger" [disabled]="removeIDs === null" (click)="deleteByIds()">Delete Libraries</button>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <br/> <br/> <br/>
      <div class="row justify-content-center">
        <h3>Change a User's Password</h3>
      </div>
      <hr/>
      <div class="row justify-content-center">
        <div class="col mb-1">
          <form #passwordChangeForm="ngForm" id = "passwordChangeForm" class="form-horizontal" novalidate role="form">
            <div class="form-group row" [ngClass]="{ 'has-error' : !email.valid && !email.pristine}">
              <label for="email" class="col-sm-3 col-form-label">Email Address:</label>
              <div class="col-sm-6">
                <input type="email" class="form-control" placeholder="Please enter and validate the email address first" id="email"
                       name="email" [(ngModel)]="newPassword.emailAddress"
                       #email = "ngModel" required/>
                <p *ngIf="!email.valid && !email.pristine" class="help-block text-danger">
                  Please enter a valid email</p>
              </div>
              <div class="col-sm-3">
                <button class="btn btn-primary" type="button" (click)="validateUser()" [disabled]="!email.valid">Validate Email</button>
              </div>
            </div>

            <div class="form-group row" [ngClass]="{ 'has-error' : !password.valid && !password.pristine}" [hidden]="hidePasswords">
              <label for="password" class="col-sm-3 col-form-label">New Password:</label>
              <div class="col-sm-9">
                <input class="form-control" placeholder="Please enter a new password" id="password"
                       name="password" type="password" [(ngModel)]="newPassword.password"
                       #password = "ngModel" required/>

                <p *ngIf="!password.valid && !password.pristine" class="help-block text-danger">
                  Please enter a valid password</p>
              </div>
            </div>

            <div class="form-group row" [ngClass]="{ 'has-error' : (!passwordMatch.valid &&
              !passwordMatch.pristine) || newPassword.password != newPassword.passwordMatch}" [hidden]="hidePasswords">
              <label for="passwordMatch" class="col-sm-3 col-form-label">Re-enter New Password:</label>
              <div class="col-sm-9">
                <input  class="form-control" type="password"  placeholder="Please re-enter the new password" id="passwordMatch"
                        name="passwordMatch" [(ngModel)]="newPassword.passwordMatch"
                        #passwordMatch = "ngModel"  [hidden]="hidePasswords" required/>

                <p *ngIf="(!passwordMatch.valid && !passwordMatch.pristine) ||
                newPassword.password != newPassword.passwordMatch" class="help-block text-danger">Passwords do not match!</p>
              </div>
            </div>

            <div class="form-group">
              <button class="btn btn-primary"
                (click)="submitPasswordChange()"
                [disabled]="!passwordChangeForm.valid" [hidden]="hidePasswords">
                Change Password
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
