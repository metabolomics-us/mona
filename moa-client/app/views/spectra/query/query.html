<form role="form" name="querySpectraDialog" novalidate>
    <div class="modal-header">
        <button type="button" class="close" ng-click="cancelDialog()" aria-hidden="true">Ã—</button>
        <h3 class="modal-title">Query Spectra</h3>

        <div><p>Below are all querieable options for our mass spectral database. You may fill in as many or as few fields as desired.</p></div>
    </div>

    <div class="modal-body">
        <accordion close-others="false">
            <accordion-group is-open="queryAccordion.name">
                <accordion-heading><div>Query by Name</div></accordion-heading>

                <div class="form-group">
                    <label class="control-label" for="nameFilter">Partial filtering by compound name:</label>
                    <input id="nameFilter"
                           name="nameFilter"
                           ng-model="query.nameFilter"
                           placeholder="Name"
                           class="form-control"/>
                </div>
            </accordion-group>


            <accordion-group is-open="queryAccordion.inchikey">
                <accordion-heading><div>Query by InChIKey</div></accordion-heading>

                <div class="form-group">
                    <label class="control-label" for="inchiFilter">Partial filtering by biological or compound
                        InChIKey:</label>
                    <input id="inchiFilter"
                           name="inchiFilter"
                           ng-model="query.inchiFilter"
                           placeholder="InChIKey"
                           ng-pattern="/^([A-Z,0-9,\-]+)+$/"
                           class="form-control"/>
                </div>
            </accordion-group>


            <accordion-group is-open="queryAccordion.accurateMass">
                <accordion-heading><div>Query by Accurate Mass</div></accordion-heading>

                <div class="form-group">
                    <label class="control-label col-sm-4" for="accurateMass">Mass:</label>

                    <div class="col-sm-8">
                        <input id="accurateMass"
                               name="accurateMass"
                               ng-model="query['Mz_exact']"
                               placeholder="Accurate Mass"
                               class="form-control"/>
                    </div>
                </div>

                <div class="form-group">
                    <label class="control-label col-sm-4" for="accurateMassTolerance">Tolerance (&pm;):</label>

                    <div class="col-sm-8">
                        <input id="accurateMassTolerance"
                               name="accurateMassTolerance"
                               ng-model="query['Mz_exact_tolerance']"
                               placeholder="Accurate Mass Tolerance"
                               class="form-control"/>
                    </div>
                </div>
            </accordion-group>


            <accordion-group is-open="queryAccordion.tags">
                <accordion-heading><div>Query by Tags</div></accordion-heading>

                <ul class="list-inline" style="text-align: center;">
                    <li ng-repeat="tag in tags">
                        <button type="button" class="btn" ng-class="tagClass(tag)" ng-click="selectTag(tag)">
                            {{tag.text}}
                            <i class="fa fa-flask" ng-show="tag.ruleBased"></i>
                        </button>
                    </li>
                </ul>
            </accordion-group>


            <accordion-group is-open="queryAccordion.metadata">
                <accordion-heading><div>Query by Metadata</div></accordion-heading>
                <label>Select an existing metadata type and then input a value to query</label>
                <br /><br />

                <div ng-repeat="meta in metadataQuery">
                    <div class="col-sm-6 form-group" ng-class="{'has-error': !meta.name && meta.name != ''}">
                        <input type="text"
                               ng-model="meta.name"
                               placeholder="Metadata Name"
                               typeahead="x for x in metadataNames | filter:$viewValue| limitTo:10"
                               typeahead-editable="false"
                               class="form-control" />
                    </div>
                    <div class="col-sm-6 form-group">
                        <input type="text"
                               ng-model="meta.value"
                               ng-disabled="!meta.name || meta.name == ''"
                               placeholder="Value to Query"
                               typeahead="x for x in queryMetadataValues(meta.name, $viewValue)"
                               class="form-control" />
                    </div>
                </div>

                <div class="col-sm-12">
                    <button type="button" class="btn btn-default btn-xs" ng-click="addMetadataQuery()">+</button>
                </div>
            </accordion-group>
        </accordion>

        </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" ng-click="submitQuery()">Submit query to system</button>
        <button class="btn btn-warning" ng-click="cancelDialog()">Close</button>
    </div>
</form>